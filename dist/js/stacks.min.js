!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Stimulus={})}(this,function(t){"use strict";var r=function(){function t(t,e){this.eventTarget=t,this.eventName=e,this.unorderedBindings=new Set}return t.prototype.connect=function(){this.eventTarget.addEventListener(this.eventName,this,!1)},t.prototype.disconnect=function(){this.eventTarget.removeEventListener(this.eventName,this,!1)},t.prototype.bindingConnected=function(t){this.unorderedBindings.add(t)},t.prototype.bindingDisconnected=function(t){this.unorderedBindings.delete(t)},t.prototype.handleEvent=function(t){for(var e=function(t){{if("immediatePropagationStopped"in t)return t;var e=t.stopImmediatePropagation;return Object.assign(t,{immediatePropagationStopped:!1,stopImmediatePropagation:function(){this.immediatePropagationStopped=!0,e.call(this)}})}}(t),n=0,r=this.bindings;n<r.length;n++){var o=r[n];if(e.immediatePropagationStopped)break;o.handleEvent(e)}},Object.defineProperty(t.prototype,"bindings",{get:function(){return Array.from(this.unorderedBindings).sort(function(t,e){var n=t.index,r=e.index;return n<r?-1:r<n?1:0})},enumerable:!0,configurable:!0}),t}();var n=function(){function t(t){this.application=t,this.eventListenerMaps=new Map,this.started=!1}return t.prototype.start=function(){this.started||(this.started=!0,this.eventListeners.forEach(function(t){return t.connect()}))},t.prototype.stop=function(){this.started&&(this.started=!1,this.eventListeners.forEach(function(t){return t.disconnect()}))},Object.defineProperty(t.prototype,"eventListeners",{get:function(){return Array.from(this.eventListenerMaps.values()).reduce(function(t,e){return t.concat(Array.from(e.values()))},[])},enumerable:!0,configurable:!0}),t.prototype.bindingConnected=function(t){this.fetchEventListenerForBinding(t).bindingConnected(t)},t.prototype.bindingDisconnected=function(t){this.fetchEventListenerForBinding(t).bindingDisconnected(t)},t.prototype.handleError=function(t,e,n){void 0===n&&(n={}),this.application.handleError(t,"Error "+e,n)},t.prototype.fetchEventListenerForBinding=function(t){var e=t.eventTarget,n=t.eventName;return this.fetchEventListener(e,n)},t.prototype.fetchEventListener=function(t,e){var n=this.fetchEventListenerMapForEventTarget(t),r=n.get(e);return r||(r=this.createEventListener(t,e),n.set(e,r)),r},t.prototype.createEventListener=function(t,e){var n=new r(t,e);return this.started&&n.connect(),n},t.prototype.fetchEventListenerMapForEventTarget=function(t){var e=this.eventListenerMaps.get(t);return e||(e=new Map,this.eventListenerMaps.set(t,e)),e},t}(),o=/^((.+?)(@(window|document))?->)?(.+?)(#(.+))?$/;function e(t){var e=t.trim().match(o)||[];return{eventTarget:function(t){{if("window"==t)return window;if("document"==t)return document}}(e[4]),eventName:e[2],identifier:e[5],methodName:e[7]}}var i=function(){function t(t,e,n){this.element=t,this.index=e,this.eventTarget=n.eventTarget||t,this.eventName=n.eventName||function(t){var e=t.tagName.toLowerCase();if(e in s)return s[e](t)}(t)||a("missing event name"),this.identifier=n.identifier||a("missing identifier"),this.methodName=n.methodName||a("missing method name")}return t.forToken=function(t){return new this(t.element,t.index,e(t.content))},t.prototype.toString=function(){var t=this.eventTargetName?"@"+this.eventTargetName:"";return""+this.eventName+t+"->"+this.identifier+"#"+this.methodName},Object.defineProperty(t.prototype,"eventTargetName",{get:function(){return(t=this.eventTarget)==window?"window":t==document?"document":void 0;var t},enumerable:!0,configurable:!0}),t}(),s={a:function(t){return"click"},button:function(t){return"click"},form:function(t){return"submit"},input:function(t){return"submit"==t.getAttribute("type")?"click":"change"},select:function(t){return"change"},textarea:function(t){return"change"}};function a(t){throw new Error(t)}var c=function(){function t(t,e){this.context=t,this.action=e}return Object.defineProperty(t.prototype,"index",{get:function(){return this.action.index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventTarget",{get:function(){return this.action.eventTarget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!0,configurable:!0}),t.prototype.handleEvent=function(t){this.willBeInvokedByEvent(t)&&this.invokeWithEvent(t)},Object.defineProperty(t.prototype,"eventName",{get:function(){return this.action.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"method",{get:function(){var t=this.controller[this.methodName];if("function"==typeof t)return t;throw new Error('Action "'+this.action+'" references undefined method "'+this.methodName+'"')},enumerable:!0,configurable:!0}),t.prototype.invokeWithEvent=function(e){try{this.method.call(this.controller,e)}catch(t){var n=this,r={identifier:n.identifier,controller:n.controller,element:n.element,index:n.index,event:e};this.context.handleError(t,'invoking action "'+this.action+'"',r)}},t.prototype.willBeInvokedByEvent=function(t){var e=t.target;return this.element===e||(!(e instanceof Element&&this.element.contains(e))||this.scope.containsElement(e))},Object.defineProperty(t.prototype,"controller",{get:function(){return this.context.controller},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"methodName",{get:function(){return this.action.methodName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scope",{get:function(){return this.context.scope},enumerable:!0,configurable:!0}),t}(),u=function(){function t(t,e){var n=this;this.element=t,this.started=!1,this.delegate=e,this.elements=new Set,this.mutationObserver=new MutationObserver(function(t){return n.processMutations(t)})}return t.prototype.start=function(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,childList:!0,subtree:!0}),this.refresh())},t.prototype.stop=function(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)},t.prototype.refresh=function(){if(this.started){for(var t=new Set(this.matchElementsInTree()),e=0,n=Array.from(this.elements);e<n.length;e++){var r=n[e];t.has(r)||this.removeElement(r)}for(var o=0,i=Array.from(t);o<i.length;o++){r=i[o];this.addElement(r)}}},t.prototype.processMutations=function(t){if(this.started)for(var e=0,n=t;e<n.length;e++){var r=n[e];this.processMutation(r)}},t.prototype.processMutation=function(t){"attributes"==t.type?this.processAttributeChange(t.target,t.attributeName):"childList"==t.type&&(this.processRemovedNodes(t.removedNodes),this.processAddedNodes(t.addedNodes))},t.prototype.processAttributeChange=function(t,e){var n=t;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,e):this.removeElement(n):this.matchElement(n)&&this.addElement(n)},t.prototype.processRemovedNodes=function(t){for(var e=0,n=Array.from(t);e<n.length;e++){var r=n[e],o=this.elementFromNode(r);o&&this.processTree(o,this.removeElement)}},t.prototype.processAddedNodes=function(t){for(var e=0,n=Array.from(t);e<n.length;e++){var r=n[e],o=this.elementFromNode(r);o&&this.elementIsActive(o)&&this.processTree(o,this.addElement)}},t.prototype.matchElement=function(t){return this.delegate.matchElement(t)},t.prototype.matchElementsInTree=function(t){return void 0===t&&(t=this.element),this.delegate.matchElementsInTree(t)},t.prototype.processTree=function(t,e){for(var n=0,r=this.matchElementsInTree(t);n<r.length;n++){var o=r[n];e.call(this,o)}},t.prototype.elementFromNode=function(t){if(t.nodeType==Node.ELEMENT_NODE)return t},t.prototype.elementIsActive=function(t){return t.isConnected==this.element.isConnected&&this.element.contains(t)},t.prototype.addElement=function(t){this.elements.has(t)||this.elementIsActive(t)&&(this.elements.add(t),this.delegate.elementMatched&&this.delegate.elementMatched(t))},t.prototype.removeElement=function(t){this.elements.has(t)&&(this.elements.delete(t),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(t))},t}(),l=function(){function t(t,e,n){this.attributeName=e,this.delegate=n,this.elementObserver=new u(t,this)}return Object.defineProperty(t.prototype,"element",{get:function(){return this.elementObserver.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selector",{get:function(){return"["+this.attributeName+"]"},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.elementObserver.start()},t.prototype.stop=function(){this.elementObserver.stop()},t.prototype.refresh=function(){this.elementObserver.refresh()},Object.defineProperty(t.prototype,"started",{get:function(){return this.elementObserver.started},enumerable:!0,configurable:!0}),t.prototype.matchElement=function(t){return t.hasAttribute(this.attributeName)},t.prototype.matchElementsInTree=function(t){var e=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector));return e.concat(n)},t.prototype.elementMatched=function(t){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(t,this.attributeName)},t.prototype.elementUnmatched=function(t){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(t,this.attributeName)},t.prototype.elementAttributeChanged=function(t,e){this.delegate.elementAttributeValueChanged&&this.attributeName==e&&this.delegate.elementAttributeValueChanged(t,e)},t}();function p(t,e,n){d(t,e).add(n)}function h(t,e,n){var r,o,i;d(t,e).delete(n),o=e,null!=(i=(r=t).get(o))&&0==i.size&&r.delete(o)}function d(t,e){var n=t.get(e);return n||(n=new Set,t.set(e,n)),n}var f,m=function(){function t(){this.valuesByKey=new Map}return Object.defineProperty(t.prototype,"values",{get:function(){return Array.from(this.valuesByKey.values()).reduce(function(t,e){return t.concat(Array.from(e))},[])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return Array.from(this.valuesByKey.values()).reduce(function(t,e){return t+e.size},0)},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){p(this.valuesByKey,t,e)},t.prototype.delete=function(t,e){h(this.valuesByKey,t,e)},t.prototype.has=function(t,e){var n=this.valuesByKey.get(t);return null!=n&&n.has(e)},t.prototype.hasKey=function(t){return this.valuesByKey.has(t)},t.prototype.hasValue=function(e){return Array.from(this.valuesByKey.values()).some(function(t){return t.has(e)})},t.prototype.getValuesForKey=function(t){var e=this.valuesByKey.get(t);return e?Array.from(e):[]},t.prototype.getKeysForValue=function(e){return Array.from(this.valuesByKey).filter(function(t){t[0];return t[1].has(e)}).map(function(t){var e=t[0];t[1];return e})},t}(),y=(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=(function(n){function t(){var t=n.call(this)||this;return t.keysByValue=new Map,t}y(t,n),Object.defineProperty(t.prototype,"values",{get:function(){return Array.from(this.keysByValue.keys())},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){n.prototype.add.call(this,t,e),p(this.keysByValue,e,t)},t.prototype.delete=function(t,e){n.prototype.delete.call(this,t,e),h(this.keysByValue,e,t)},t.prototype.hasValue=function(t){return this.keysByValue.has(t)},t.prototype.getKeysForValue=function(t){var e=this.keysByValue.get(t);return e?Array.from(e):[]}}(m),function(){function t(t,e,n){this.attributeObserver=new l(t,e,this),this.delegate=n,this.tokensByElement=new m}return Object.defineProperty(t.prototype,"started",{get:function(){return this.attributeObserver.started},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.attributeObserver.start()},t.prototype.stop=function(){this.attributeObserver.stop()},t.prototype.refresh=function(){this.attributeObserver.refresh()},Object.defineProperty(t.prototype,"element",{get:function(){return this.attributeObserver.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attributeName",{get:function(){return this.attributeObserver.attributeName},enumerable:!0,configurable:!0}),t.prototype.elementMatchedAttribute=function(t){this.tokensMatched(this.readTokensForElement(t))},t.prototype.elementAttributeValueChanged=function(t){var e=this.refreshTokensForElement(t),n=e[0],r=e[1];this.tokensUnmatched(n),this.tokensMatched(r)},t.prototype.elementUnmatchedAttribute=function(t){this.tokensUnmatched(this.tokensByElement.getValuesForKey(t))},t.prototype.tokensMatched=function(t){var e=this;t.forEach(function(t){return e.tokenMatched(t)})},t.prototype.tokensUnmatched=function(t){var e=this;t.forEach(function(t){return e.tokenUnmatched(t)})},t.prototype.tokenMatched=function(t){this.delegate.tokenMatched(t),this.tokensByElement.add(t.element,t)},t.prototype.tokenUnmatched=function(t){this.delegate.tokenUnmatched(t),this.tokensByElement.delete(t.element,t)},t.prototype.refreshTokensForElement=function(t){var n,r,e,o=this.tokensByElement.getValuesForKey(t),i=this.readTokensForElement(t),s=(n=o,r=i,e=Math.max(n.length,r.length),Array.from({length:e},function(t,e){return[n[e],r[e]]})).findIndex(function(t){var e,n,r=t[0],o=t[1];return n=o,!((e=r)&&n&&e.index==n.index&&e.content==n.content)});return-1==s?[[],[]]:[o.slice(s),i.slice(s)]},t.prototype.readTokensForElement=function(t){var n,r,e=this.attributeName,o=t.getAttribute(e)||"";return n=t,r=e,o.trim().split(/\s+/).filter(function(t){return t.length}).map(function(t,e){return{element:n,attributeName:r,content:t,index:e}})},t}());var v,g=function(){function t(t,e,n){this.tokenListObserver=new b(t,e,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}return Object.defineProperty(t.prototype,"started",{get:function(){return this.tokenListObserver.started},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.tokenListObserver.start()},t.prototype.stop=function(){this.tokenListObserver.stop()},t.prototype.refresh=function(){this.tokenListObserver.refresh()},Object.defineProperty(t.prototype,"element",{get:function(){return this.tokenListObserver.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attributeName",{get:function(){return this.tokenListObserver.attributeName},enumerable:!0,configurable:!0}),t.prototype.tokenMatched=function(t){var e=t.element,n=this.fetchParseResultForToken(t).value;n&&(this.fetchValuesByTokenForElement(e).set(t,n),this.delegate.elementMatchedValue(e,n))},t.prototype.tokenUnmatched=function(t){var e=t.element,n=this.fetchParseResultForToken(t).value;n&&(this.fetchValuesByTokenForElement(e).delete(t),this.delegate.elementUnmatchedValue(e,n))},t.prototype.fetchParseResultForToken=function(t){var e=this.parseResultsByToken.get(t);return e||(e=this.parseToken(t),this.parseResultsByToken.set(t,e)),e},t.prototype.fetchValuesByTokenForElement=function(t){var e=this.valuesByTokenByElement.get(t);return e||(e=new Map,this.valuesByTokenByElement.set(t,e)),e},t.prototype.parseToken=function(t){try{return{value:this.delegate.parseValueForToken(t)}}catch(t){return{error:t}}},t}(),E=function(){function t(t,e){this.context=t,this.delegate=e,this.bindingsByAction=new Map}return t.prototype.start=function(){this.valueListObserver||(this.valueListObserver=new g(this.element,this.actionAttribute,this),this.valueListObserver.start())},t.prototype.stop=function(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())},Object.defineProperty(t.prototype,"element",{get:function(){return this.context.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this.context.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actionAttribute",{get:function(){return this.schema.actionAttribute},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return this.context.schema},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return Array.from(this.bindingsByAction.values())},enumerable:!0,configurable:!0}),t.prototype.connectAction=function(t){var e=new c(this.context,t);this.bindingsByAction.set(t,e),this.delegate.bindingConnected(e)},t.prototype.disconnectAction=function(t){var e=this.bindingsByAction.get(t);e&&(this.bindingsByAction.delete(t),this.delegate.bindingDisconnected(e))},t.prototype.disconnectAllActions=function(){var e=this;this.bindings.forEach(function(t){return e.delegate.bindingDisconnected(t)}),this.bindingsByAction.clear()},t.prototype.parseValueForToken=function(t){var e=i.forToken(t);if(e.identifier==this.identifier)return e},t.prototype.elementMatchedValue=function(t,e){this.connectAction(e)},t.prototype.elementUnmatchedValue=function(t,e){this.disconnectAction(e)},t}(),O=function(){function t(t,e){this.module=t,this.scope=e,this.controller=new t.controllerConstructor(this),this.bindingObserver=new E(this,this.dispatcher);try{this.controller.initialize()}catch(t){this.handleError(t,"initializing controller")}}return t.prototype.connect=function(){this.bindingObserver.start();try{this.controller.connect()}catch(t){this.handleError(t,"connecting controller")}},t.prototype.disconnect=function(){try{this.controller.disconnect()}catch(t){this.handleError(t,"disconnecting controller")}this.bindingObserver.stop()},Object.defineProperty(t.prototype,"application",{get:function(){return this.module.application},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this.module.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return this.application.schema},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dispatcher",{get:function(){return this.application.dispatcher},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return this.element.parentElement},enumerable:!0,configurable:!0}),t.prototype.handleError=function(t,e,n){void 0===n&&(n={});var r=this.identifier,o=this.controller,i=this.element;n=Object.assign({identifier:r,controller:o,element:i},n),this.application.handleError(t,"Error "+e,n)},t}(),w=(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function A(t){return{identifier:t.identifier,controllerConstructor:(e=t.controllerConstructor,n=_(e),n.bless(),n)};var e,n}var _=function(){function t(e){function n(){var t=this&&this instanceof n?this.constructor:void 0;return Reflect.construct(e,arguments,t)}return n.prototype=Object.create(e.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,e),n}try{return(e=t(function(){this.a.call(this)})).prototype.a=function(){},new e,t}catch(t){return function(t){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return w(e,t),e}(t)}}var e}(),k=function(){function t(t,e){this.application=t,this.definition=A(e),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}return Object.defineProperty(t.prototype,"identifier",{get:function(){return this.definition.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controllerConstructor",{get:function(){return this.definition.controllerConstructor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contexts",{get:function(){return Array.from(this.connectedContexts)},enumerable:!0,configurable:!0}),t.prototype.connectContextForScope=function(t){var e=this.fetchContextForScope(t);this.connectedContexts.add(e),e.connect()},t.prototype.disconnectContextForScope=function(t){var e=this.contextsByScope.get(t);e&&(this.connectedContexts.delete(e),e.disconnect())},t.prototype.fetchContextForScope=function(t){var e=this.contextsByScope.get(t);return e||(e=new O(this,t),this.contextsByScope.set(t,e)),e},t}(),C=function(){function t(t){this.scope=t}return Object.defineProperty(t.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!0,configurable:!0}),t.prototype.get=function(t){return t=this.getFormattedKey(t),this.element.getAttribute(t)},t.prototype.set=function(t,e){return t=this.getFormattedKey(t),this.element.setAttribute(t,e),this.get(t)},t.prototype.has=function(t){return t=this.getFormattedKey(t),this.element.hasAttribute(t)},t.prototype.delete=function(t){return!!this.has(t)&&(t=this.getFormattedKey(t),this.element.removeAttribute(t),!0)},t.prototype.getFormattedKey=function(t){return"data-"+this.identifier+"-"+t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})},t}();function P(t,e){return"["+t+'~="'+e+'"]'}var x=function(){function t(t){this.scope=t}return Object.defineProperty(t.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return this.scope.schema},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return null!=this.find(t)},t.prototype.find=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.getSelectorForTargetNames(t);return this.scope.findElement(n)},t.prototype.findAll=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.getSelectorForTargetNames(t);return this.scope.findAllElements(n)},t.prototype.getSelectorForTargetNames=function(t){var e=this;return t.map(function(t){return e.getSelectorForTargetName(t)}).join(", ")},t.prototype.getSelectorForTargetName=function(t){var e=this.identifier+"."+t;return P(this.schema.targetAttribute,e)},t}(),T=function(){function t(t,e,n){this.schema=t,this.identifier=e,this.element=n,this.targets=new x(this),this.data=new C(this)}return t.prototype.findElement=function(t){return this.findAllElements(t)[0]},t.prototype.findAllElements=function(t){var e=this.element.matches(t)?[this.element]:[],n=this.filterElements(Array.from(this.element.querySelectorAll(t)));return e.concat(n)},t.prototype.filterElements=function(t){var e=this;return t.filter(function(t){return e.containsElement(t)})},t.prototype.containsElement=function(t){return t.closest(this.controllerSelector)===this.element},Object.defineProperty(t.prototype,"controllerSelector",{get:function(){return P(this.schema.controllerAttribute,this.identifier)},enumerable:!0,configurable:!0}),t}(),S=function(){function t(t,e,n){this.element=t,this.schema=e,this.delegate=n,this.valueListObserver=new g(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}return t.prototype.start=function(){this.valueListObserver.start()},t.prototype.stop=function(){this.valueListObserver.stop()},Object.defineProperty(t.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!0,configurable:!0}),t.prototype.parseValueForToken=function(t){var e=t.element,n=t.content,r=this.fetchScopesByIdentifierForElement(e),o=r.get(n);return o||(o=new T(this.schema,n,e),r.set(n,o)),o},t.prototype.elementMatchedValue=function(t,e){var n=(this.scopeReferenceCounts.get(e)||0)+1;this.scopeReferenceCounts.set(e,n),1==n&&this.delegate.scopeConnected(e)},t.prototype.elementUnmatchedValue=function(t,e){var n=this.scopeReferenceCounts.get(e);n&&(this.scopeReferenceCounts.set(e,n-1),1==n&&this.delegate.scopeDisconnected(e))},t.prototype.fetchScopesByIdentifierForElement=function(t){var e=this.scopesByIdentifierByElement.get(t);return e||(e=new Map,this.scopesByIdentifierByElement.set(t,e)),e},t}(),j=function(){function t(t){this.application=t,this.scopeObserver=new S(this.element,this.schema,this),this.scopesByIdentifier=new m,this.modulesByIdentifier=new Map}return Object.defineProperty(t.prototype,"element",{get:function(){return this.application.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"schema",{get:function(){return this.application.schema},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controllerAttribute",{get:function(){return this.schema.controllerAttribute},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modules",{get:function(){return Array.from(this.modulesByIdentifier.values())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contexts",{get:function(){return this.modules.reduce(function(t,e){return t.concat(e.contexts)},[])},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.scopeObserver.start()},t.prototype.stop=function(){this.scopeObserver.stop()},t.prototype.loadDefinition=function(t){this.unloadIdentifier(t.identifier);var e=new k(this.application,t);this.connectModule(e)},t.prototype.unloadIdentifier=function(t){var e=this.modulesByIdentifier.get(t);e&&this.disconnectModule(e)},t.prototype.getContextForElementAndIdentifier=function(e,t){var n=this.modulesByIdentifier.get(t);if(n)return n.contexts.find(function(t){return t.element==e})},t.prototype.handleError=function(t,e,n){this.application.handleError(t,e,n)},t.prototype.scopeConnected=function(t){this.scopesByIdentifier.add(t.identifier,t);var e=this.modulesByIdentifier.get(t.identifier);e&&e.connectContextForScope(t)},t.prototype.scopeDisconnected=function(t){this.scopesByIdentifier.delete(t.identifier,t);var e=this.modulesByIdentifier.get(t.identifier);e&&e.disconnectContextForScope(t)},t.prototype.connectModule=function(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(function(t){return e.connectContextForScope(t)})},t.prototype.disconnectModule=function(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(function(t){return e.disconnectContextForScope(t)})},t}(),B={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target"},L=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},F=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=i[2&e[0]?"return":e[0]?"throw":"next"])&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[0,s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},M=function(){function r(t,e){void 0===t&&(t=document.documentElement),void 0===e&&(e=B),this.element=t,this.schema=e,this.dispatcher=new n(this),this.router=new j(this)}return r.start=function(t,e){var n=new r(t,e);return n.start(),n},r.prototype.start=function(){return L(this,void 0,void 0,function(){return F(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",t):t()})];case 1:return t.sent(),this.router.start(),this.dispatcher.start(),[2]}})})},r.prototype.stop=function(){this.router.stop(),this.dispatcher.stop()},r.prototype.register=function(t,e){this.load({identifier:t,controllerConstructor:e})},r.prototype.load=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(Array.isArray(t)?t:[t].concat(n)).forEach(function(t){return e.router.loadDefinition(t)})},r.prototype.unload=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(Array.isArray(t)?t:[t].concat(n)).forEach(function(t){return e.router.unloadIdentifier(t)})},Object.defineProperty(r.prototype,"controllers",{get:function(){return this.router.contexts.map(function(t){return t.controller})},enumerable:!0,configurable:!0}),r.prototype.getControllerForElementAndIdentifier=function(t,e){var n=this.router.getContextForElementAndIdentifier(t,e);return n?n.controller:null},r.prototype.handleError=function(t,e,n){console.error("%s\n\n%o\n\n%o",e,t,n)},r}();function N(t){var e,i=t.prototype;(e=function(t){var e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e}(t),Array.from(e.reduce(function(e,t){var n,r;return(n=t,r=n.targets,Array.isArray(r)?r:[]).forEach(function(t){return e.add(t)}),e},new Set))).forEach(function(e){var t,n,r,o;return n=i,(t={})[e+"Target"]={get:function(){var t=this.targets.find(e);if(t)return t;throw new Error('Missing target element "'+this.identifier+"."+e+'"')}},t[e+"Targets"]={get:function(){return this.targets.findAll(e)}},t["has"+(o=e,o.charAt(0).toUpperCase()+o.slice(1))+"Target"]={get:function(){return this.targets.has(e)}},r=t,void Object.keys(r).forEach(function(t){if(!(t in n)){var e=r[t];Object.defineProperty(n,t,e)}})})}var I=function(){function t(t){this.context=t}return t.bless=function(){N(this)},Object.defineProperty(t.prototype,"application",{get:function(){return this.context.application},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scope",{get:function(){return this.context.scope},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this.scope.element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this.scope.identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targets",{get:function(){return this.scope.targets},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.scope.data},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){},t.prototype.connect=function(){},t.prototype.disconnect=function(){},t.targets=[],t}();t.Application=M,t.Context=O,t.Controller=I,t.defaultSchema=B,Object.defineProperty(t,"__esModule",{value:!0})});var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(u){var t=function(c){function r(){return null!==c&&c.apply(this,arguments)||this}return __extends(r,c),r.prototype.load=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=Array.isArray(t)?t:[t].concat(e),o=0,i=r;o<i.length;o++){var s=i[o],a=/^s-/.test(s.identifier);if(u._initializing&&!a)throw'Stacks-created Stimulus controller names must start with "s-".';if(!u._initializing&&a)throw'The "s-" prefix on Stimulus controller names is reserved for Stacks-created controllers.'}c.prototype.load.call(this,r)},r.start=function(t,e){var n=new r(t,e);return n.start(),n},r}(Stimulus.Application);u.application=t.start(),u._initializing=!0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getElementData=function(t,e){return t.getAttribute("data-"+this.identifier+"-"+e)},e.prototype.setElementData=function(t,e,n){t.setAttribute("data-"+this.identifier+"-"+e,n)},e.prototype.removeElementData=function(t,e){t.removeAttribute("data-"+this.identifier+"-"+e)},e.prototype.triggerEvent=function(t,e,n){var r,o=this.identifier+":"+t;try{r=new CustomEvent(o,{bubbles:!0,cancelable:!0,detail:e})}catch(t){(r=document.createEvent("CustomEvent")).initCustomEvent(o,!0,!0,e)}return(n||this.element).dispatchEvent(r),r},e}(Stimulus.Controller);function n(t){var e,n=t.hasOwnProperty("targets")?((e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o)).targets=t.targets,e):function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(o);for(var r in t)"targets"!==r&&t.hasOwnProperty(r)&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t,r));return n}u.StacksController=o,u.createController=n,u.addController=function(t,e){u.application.register(t,n(e))}}(Stacks||(Stacks={}));__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(){var r="s-expandable-control:radio-off";function e(n){var t=n.target;t instanceof HTMLInputElement&&"INPUT"===t.nodeName&&"radio"===t.type&&document.querySelectorAll('input[type="radio"][name="'+t.name+'"]').forEach(function(t){if(t!==n.target){var e;try{e=new Event(r)}catch(t){(e=document.createEvent("Event")).initEvent(r,!0,!0)}t.dispatchEvent(e)}})}var n=0;function o(t){t?1===++n&&document.body.addEventListener("change",e):0===--n&&document.body.removeEventListener("change",e)}Stacks.application.register("s-expandable-control",function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initialize=function(){"INPUT"===this.element.nodeName&&0<=["radio","checkbox"].indexOf(this.element.type)?(this.isCollapsed=this._isCollapsedForCheckable,this.events=["change",r],this.isCheckable=!0,this.isRadio="radio"===this.element.type):(this.isCollapsed=this._isCollapsedForClickable,this.events=["click","keydown"]),this.listener=this.listener.bind(this)},e.prototype._isCollapsedForClickable=function(){var t=this.controlledCollapsible;return t?!t.classList.contains("is-expanded"):"false"===this.element.getAttribute("aria-expanded")},e.prototype._isCollapsedForCheckable=function(){return!this.element.checked},Object.defineProperty(e.prototype,"controlledCollapsible",{get:function(){var t=this.element.getAttribute("aria-controls");if(!t)throw"couldn't find controls";var e=document.getElementById(t);if(!e)throw"couldn't find controls";return e},enumerable:!0,configurable:!0}),e.prototype._dispatchShowHideEvent=function(t){this.triggerEvent(t?"show":"hide")},e.prototype._toggleClass=function(e){if(this.data.has("toggle-class")){var n=this.element.classList,t=this.data.get("toggle-class");if(!t)throw"couldn't find toggle class";t.split(/\s+/).forEach(function(t){n.toggle(t,!!e)})}},e.prototype.listener=function(t){var e;if(this.isCheckable)e=!this.element.checked;else{if("keydown"==t.type&&t instanceof KeyboardEvent&&13!=t.keyCode&&32!=t.keyCode)return;if(t.target!==t.currentTarget&&0<=["A","BUTTON"].indexOf(t.target.nodeName))return;e="true"===this.element.getAttribute("aria-expanded"),t.preventDefault(),"click"===t.type&&this.element.blur()}this.element.setAttribute("aria-expanded",e?"false":"true"),this.controlledCollapsible.classList.toggle("is-expanded",!e),this._dispatchShowHideEvent(!e),this._toggleClass(!e)},e.prototype.connect=function(){var e=this;if(this.events.forEach(function(t){e.element.addEventListener(t,e.listener)},this),this.isRadio&&o(!0),this.element.setAttribute("aria-expanded",this.isCollapsed()?"false":"true"),this.isCheckable){var t=this.controlledCollapsible;if(t){var n=!this.isCollapsed();n!==t.classList.contains("is-expanded")&&(t.classList.toggle("is-expanded",n),this._dispatchShowHideEvent(n),this._toggleClass(n))}}},e.prototype.disconnect=function(){var e=this;this.events.forEach(function(t){e.element.removeEventListener(t,e.listener)},this),this.isRadio&&o(!1)},e}(Stacks.StacksController))}();__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(r){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.connect=function(){this.validate()},e.prototype.disconnect=function(){this.unbindDocumentEvents()},e.prototype.toggle=function(){this._toggle()},e.prototype.show=function(){this._toggle(!0)},e.prototype.hide=function(){this._toggle(!1)},e.prototype.validate=function(){var t=this.data.get("return-element");if(t&&(this.returnElement=document.querySelector(t),!this.returnElement))throw"Unable to find element by return-element selector: "+t},e.prototype._toggle=function(t){var e=this,n=t,r="false"===this.modalTarget.getAttribute("aria-hidden");if(void 0===n&&(n=!r),!(n&&r||!n&&!r)){var o=this.triggerEvent(n?"show":"hide",{returnElement:this.returnElement});if(!o.defaultPrevented)this.returnElement=o.detail.returnElement,this.modalTarget.setAttribute("aria-hidden",n?"false":"true"),n?this.bindDocumentEvents():(this.unbindDocumentEvents(),this.focusReturnElement(),this.removeModalOnHide()),void 0!==this.modalTarget.ontransitionend?this.modalTarget.addEventListener("transitionend",function(){e.triggerEvent(n?"shown":"hidden")},{once:!0}):this.triggerEvent(n?"shown":"hidden")}},e.prototype.focusReturnElement=function(){var t=this;this.returnElement&&this.modalTarget.addEventListener("s-modal:hidden",function(){t.returnElement&&document.body.contains(t.returnElement)&&t.returnElement.focus()},{once:!0})},e.prototype.removeModalOnHide=function(){var t=this;"true"===this.data.get("remove-when-hidden")&&this.modalTarget.addEventListener("s-modal:hidden",function(){t.element.remove()},{once:!0})},e.prototype.handleFocusableElements=function(){var e=this,t=Array.from(this.modalTarget.querySelectorAll("[href], input, select, textarea, button, [tabindex]")).filter(function(t){return t.matches(":not([disabled]):not([tabindex='-1'])")});if(t.length){var n=t[0];this.hasInitialFocusTarget&&(n=this.initialFocusTarget),this.modalTarget.addEventListener("s-modal:shown",function(){n&&document.body.contains(n)&&n.focus()},{once:!0});var r=t[0],o=t[t.length-1];return this._boundTabTrap=this._boundTabTrap||function(t){e.modalTarget.contains(t.target)||(t.preventDefault(),r.focus()),t.target==r&&9===t.keyCode&&t.shiftKey&&(t.preventDefault(),o.focus()),t.target!=o||9!==t.keyCode||t.shiftKey||(t.preventDefault(),r.focus())},document.addEventListener("keydown",this._boundTabTrap),n}},e.prototype.bindDocumentEvents=function(){this._boundClickFn=this._boundClickFn||this.hideOnOutsideClick.bind(this),this._boundKeypressFn=this._boundKeypressFn||this.hideOnEscapePress.bind(this),document.addEventListener("mousedown",this._boundClickFn),document.addEventListener("keyup",this._boundKeypressFn),this.handleFocusableElements()},e.prototype.unbindDocumentEvents=function(){document.removeEventListener("mousedown",this._boundClickFn),document.removeEventListener("keyup",this._boundKeypressFn),document.removeEventListener("keydown",this._boundTabTrap)},e.prototype.hideOnOutsideClick=function(t){var e=t.target;!this.modalTarget.querySelector(".s-modal--dialog").contains(e)&&document.body.contains(e)&&this._toggle(!1)},e.prototype.hideOnEscapePress=function(t){27===t.which&&"true"!==this.modalTarget.getAttribute("aria-hidden")&&this._toggle(!1)},e.targets=["modal","initialFocus"],e}(r.StacksController);function e(t,e){var n=r.application.getControllerForElementAndIdentifier(t,"s-modal");if(!n)throw"Unable to get s-modal controller from element";e?n.show():n.hide()}r.ModalController=t,r.showModal=function(t){e(t,!0)},r.hideModal=function(t){e(t,!1)}}(Stacks||(Stacks={})),Stacks.application.register("s-modal",Stacks.ModalController);__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"isVisible",{get:function(){var t=this.popoverElement;return!!t&&t.classList.contains("is-visible")},enumerable:!0,configurable:!0}),e.prototype.connect=function(){t.prototype.connect.call(this),this.validate(),this.isVisible&&this.initializePopper()},e.prototype.disconnect=function(){this.hide(),this.popper&&(this.popper.destroy(),this.popper=null),t.prototype.disconnect.call(this)},e.prototype.toggle=function(){this.isVisible?this.hide():this.show()},e.prototype.show=function(){this.isVisible||this.triggerEvent("show").defaultPrevented||(this.popper||this.initializePopper(),this.popoverElement.classList.add("is-visible"),this.scheduleUpdate(),this.shown())},e.prototype.hide=function(){this.isVisible&&(this.triggerEvent("hide").defaultPrevented||(this.popoverElement.classList.remove("is-visible"),this.popper&&(this.popper.destroy(),this.popper=null),this.hidden()))},e.prototype.shown=function(){this.bindDocumentEvents(),this.triggerEvent("shown")},e.prototype.hidden=function(){this.unbindDocumentEvents(),this.triggerEvent("hidden")},e.prototype.generatePopover=function(){return null},e.prototype.initializePopper=function(){this.popper=Popper.createPopper(this.referenceElement,this.popoverElement,{placement:this.data.get("placement")||"bottom",modifiers:[{name:"offset",options:{offset:[0,10]}}]})},e.prototype.validate=function(){var t=this.data.get("reference-selector");if(this.referenceElement=this.element,t&&(this.referenceElement=this.element.querySelector(t),!this.referenceElement))throw"Unable to find element by reference selector: "+t;var e=this.referenceElement.getAttribute(this.popoverSelectorAttribute),n=null;if(e){if(!(n=document.getElementById(e)))throw"["+this.popoverSelectorAttribute+'="{POPOVER_ID}"] required'}else n=this.generatePopover();if(!n)throw"unable to find or generate popover element";this.popoverElement=n},e.prototype.scheduleUpdate=function(){this.popper&&this.isVisible&&this.popper.update()},e}(t.StacksController),n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popoverSelectorAttribute="aria-controls",t}return __extends(t,e),t.prototype.shown=function(){this.toggleOptionalClasses(!0),e.prototype.shown.call(this)},t.prototype.hidden=function(){this.toggleOptionalClasses(!1),e.prototype.hidden.call(this)},t.prototype.bindDocumentEvents=function(){this.boundHideOnOutsideClick=this.boundHideOnOutsideClick||this.hideOnOutsideClick.bind(this),this.boundHideOnEscapePress=this.boundHideOnEscapePress||this.hideOnEscapePress.bind(this),document.addEventListener("mousedown",this.boundHideOnOutsideClick),document.addEventListener("keyup",this.boundHideOnEscapePress)},t.prototype.unbindDocumentEvents=function(){document.removeEventListener("mousedown",this.boundHideOnOutsideClick),document.removeEventListener("keyup",this.boundHideOnEscapePress)},t.prototype.hideOnOutsideClick=function(t){var e=t.target;this.referenceElement.contains(e)||this.popoverElement.contains(e)||!document.body.contains(e)||this.hide()},t.prototype.hideOnEscapePress=function(t){27===t.which&&this.isVisible&&(this.popoverElement.contains(t.target)&&this.referenceElement.focus(),this.hide())},t.prototype.toggleOptionalClasses=function(e){if(this.data.has("toggle-class")){var n=this.referenceElement.classList;this.data.get("toggle-class").split(/\s+/).forEach(function(t){n.toggle(t,e)})}},t.targets=[],t}(t.BasePopoverController=e);t.PopoverController=n}(Stacks||(Stacks={})),Stacks.application.register("s-popover",Stacks.PopoverController);__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(){var t;function h(t,e){for(var n=[],r=t.children[0],o=[],i=[];r||i.some(function(t){return 0!==t});){var s=[];n.push(s);var a=0;if(r)for(var c=0;c<r.children.length;c++){for(;i[a];)i[a]--,s[a]=o[a],a++;var u=r.children[c];if(!(u instanceof HTMLTableCellElement))throw"invalid table";if("none"!==getComputedStyle(u).display){if(u===e)return a;for(var l=a+u.colSpan;a<l;a++)i[a]=u.rowSpan-1,o[a]=u,s[a]=u}}for(;a<o.length;)i[a]&&(i[a]--,s[a]=o[a]),a++;r&&(r=r.nextElementSibling)}return e?-1:n}Stacks.application.register("s-table",((t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setCurrentSort=function(e,r){if(["asc","desc","none"].indexOf(r)<0)throw"direction must be one of asc, desc, or none";var o=this;this.columnTargets.forEach(function(t){var n=t===e;t.classList.toggle("is-sorted",n&&"none"!==r),t.querySelectorAll(".js-sorting-indicator").forEach(function(t){var e=n?r:"none";t.classList.toggle("d-none",!t.classList.contains("js-sorting-indicator-"+e))}),n&&"none"!==r?o.setElementData(t,"sort-direction",r):o.removeElementData(t,"sort-direction")})},e.prototype.sort=function(t){var s=this,e=t.currentTarget;if(!(e instanceof HTMLTableCellElement))throw"invalid event target";var n=this.element,r=n.tBodies[0],a=function(t){if(!(t.parentElement&&t.parentElement.parentElement instanceof HTMLTableSectionElement))throw"invalid table";var e=h(t.parentElement.parentElement,t);if("number"!=typeof e)throw"shouldn't happen";return e}(e);if(!(a<0)){var c,u=function(t){var e=h(t);if(!(e instanceof Array))throw"shouldn't happen";return e}(r),o="asc"===this.getElementData(e,"sort-direction")?-1:1,i=Array.from(n.tBodies[0].rows),l=!1,p=[];i.forEach(function(t,e){var n=s.getElementData(t,"sort-to");if("top"!==n)if("bottom"!==n){var r=u[e][a];if(r){var o=s.getElementData(r,"sort-val"),i="string"==typeof o?o:r.textContent.trim();""!==i&&parseInt(i,10)+""!==i&&(l=!0),p.push([i,e])}else p.push(["",e])}else c||(c=t)}),l||p.forEach(function(t){t[0]=""===t[0]?Number.MIN_VALUE:parseInt(t[0],10)}),p.sort(function(t,e){return t[0]>e[0]?1*o:t[0]<e[0]?-1*o:t[1]>e[1]?1:-1}),p.forEach(function(t){var e=i[t[1]];e.parentElement.removeChild(e),c?r.insertBefore(e,c):r.appendChild(e)}),this.setCurrentSort(e,1===o?"asc":"desc")}},e}(Stacks.StacksController)).targets=["column"],t))}();var Stacks;__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(r){var t=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.popoverSelectorAttribute="aria-describedby",t}return __extends(a,e),a.prototype.connect=function(){e.prototype.connect.call(this),window.matchMedia("(hover: hover)").matches&&this.bindMouseEvents()},a.prototype.disconnect=function(){this.unbindMouseEvents(),e.prototype.disconnect.call(this)},a.prototype.show=function(){var t=r.application.getControllerForElementAndIdentifier(this.element,"s-popover");t&&t.isVisible||e.prototype.show.call(this)},a.prototype.applyTitleAttributes=function(){var t,e=this.data.get("html-title");if(e)t=document.createRange().createContextualFragment(e);else{var n=this.element.getAttribute("title");if(!n)return null;t=document.createTextNode(n)}this.data.delete("html-title"),this.element.removeAttribute("title");var r=this.element.getAttribute("aria-describedby");r||(r=a.generateId(),this.element.setAttribute("aria-describedby",r));var o=document.getElementById(r);if(!o){(o=document.createElement("div")).id=r,o.className="s-popover s-popover__tooltip pe-none",o.setAttribute("aria-hidden","true"),o.setAttribute("role","tooltip");var i=this.element.parentNode;i?i.insertBefore(o,this.element.nextSibling):document.body.appendChild(o)}var s=o.querySelector(".s-popover--arrow");return o.innerHTML="",o.appendChild(t),s?o.appendChild(s):o.insertAdjacentHTML("beforeend",'<div class="s-popover--arrow"></div>'),this.scheduleUpdate(),o},a.prototype.bindDocumentEvents=function(){this.boundHideIfWithin=this.boundHideIfWithin||this.hideIfWithin.bind(this),document.addEventListener("s-popover:shown",this.boundHideIfWithin)},a.prototype.unbindDocumentEvents=function(){document.removeEventListener("s-popover:shown",this.boundHideIfWithin)},a.prototype.generatePopover=function(){return this.applyTitleAttributes()},a.prototype.hideIfWithin=function(t){t.target.contains(this.referenceElement)&&this.hide()},a.prototype.bindMouseEvents=function(){this.boundShow=this.boundShow||this.show.bind(this),this.boundHide=this.boundHide||this.hide.bind(this),this.referenceElement.addEventListener("mouseover",this.boundShow),this.referenceElement.addEventListener("mouseout",this.boundHide)},a.prototype.unbindMouseEvents=function(){this.referenceElement.removeEventListener("mouseover",this.boundShow),this.referenceElement.removeEventListener("mouseout",this.boundHide)},a.generateId=function(){return"--stacks-s-tooltip-"+Math.random().toString(36).substring(2,10)},a.targets=[],a}(r.BasePopoverController);function o(t,e){e&&e.placement&&t.setAttribute("data-s-tooltip-placement",e.placement);var n=r.application.getControllerForElementAndIdentifier(t,"s-tooltip");n?n.applyTitleAttributes():t.setAttribute("data-controller",t.getAttribute("data-controller")+" s-tooltip")}r.TooltipController=t,r.setTooltipHtml=function(t,e,n){t.setAttribute("data-s-tooltip-html-title",e),t.removeAttribute("title"),o(t,n)},r.setTooltipText=function(t,e,n){t.setAttribute("title",e),t.removeAttribute("data-s-tooltip-html-title"),o(t,n)}}(Stacks||(Stacks={})),Stacks.application.register("s-tooltip",Stacks.TooltipController),Stacks._initializing=!1;