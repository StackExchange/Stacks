.s-tag {
    // Base
    --_ta-bc: var(--theme-tag-border-color, var(--_ta-bg));
    --_ta-bg: var(--theme-tag-background-color, var(--black-150));
    --_ta-fc: var(--theme-tag-color, var(--black-500));
    // Hover
    --_ta-bc-hover: var(--theme-tag-hover-border-color, var(--_ta-bg-hover));
    --_ta-bg-hover: var(--theme-tag-hover-background-color, var(--black-200));
    --_ta-fc-hover: var(--theme-tag-hover-color, var(--black-600));
    // Other
    --_ta-br: var(--br-sm);
    --_ta-fs: var(--fs-caption);
    --_ta-lh: 1.846153846;
    --_ta-pl: var(--_ta-px);
    --_ta-pr: var(--_ta-px);
    --_ta-px: var(--su4);
    --_ta-dismiss-padding: calc(var(--_ta-px) - var(--su-static1));

    // CONTEXTUAL STYLES
    .highcontrast-mode({
        &:not(&__moderator):not(&__required) {
            --_ta-bc: var(--theme-tag-border-color, var(--black-300));
            --_ta-bc-hover: var(--theme-tag-hover-border-color, var(--black-300));
        }
    });

    // MODIFIERS
    // Sizes
    &&__xs {
        .size-styles(xs; ta; @styles: fs);
        --_ta-lh: 1.4;
        --_ta-px: var(--su2);
    }
    &&__sm {
        .size-styles(sm; ta; @styles: fs);
        --_ta-lh: 1.5;
    }
    &&__md {
        --_ta-px: var(--su6);
        --_ta-fs: var(--fs-body2);
        --_ta-lh: 1.733333333;
    }
    &&__lg {
        --_ta-br: calc(var(--br-sm) + var(--su-static1));
        --_ta-fs: var(--fs-subheading);
        --_ta-lh: 1.684210526;
        --_ta-px: var(--su6);
    }

    // VARIANTS
    // NOTE: ignored and watched variants are used in core with the .post-tag class (in place of the base tag .s-tag)
    &__ignored, // TODO: remove all single `&` ignored styles once core no longer requires them
    &&__ignored,
    &__watched, // TODO: remove all single `&` watched styles once core no longer requires them
    &&__watched {
        --_ta-pl: calc(var(--su-static24) - var(--su-static2)); // 22px
        --_ta-before-size: calc(var(--su-static16) - var(--su-static2)); // 14px
        // --_ta-before-icon defined per variant

        &:before {
            height: var(--_ta-before-size);
            width: var(--_ta-before-size);
            -webkit-mask: var(--_ta-before-icon) no-repeat center;
            mask: var(--_ta-before-icon) no-repeat center;

            background-color: currentColor;
            content: "";
            display: block;
            left: var(--su-static4);
            margin-right: var(--su2);
            position: absolute;
            top: calc(50% - calc(var(--su-static8) - var(--su-static1)));
            -webkit-mask-size: contain;
            mask-size: contain;
        }

        position: relative;
    }

    &__ignored, // TODO: remove all single `&` ignored styles once core no longer requires them
    &&__ignored {
        --_ta-before-icon: url("data:image/svg+xml;,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 14 14'%3E%3Cpath d='M3.52 7.38 1.58 9.26A12.38 12.38 0 0 1 0 7s2.63-5.14 7.05-5.14c.66 0 1.28.12 1.86.32L7.44 3.6a3.48 3.48 0 0 0-3.92 3.78ZM5.3 9.99c.5.28 1.1.44 1.71.44 1.94 0 3.5-1.53 3.5-3.43 0-.62-.17-1.21-.47-1.72L8.7 6.6a1.73 1.73 0 0 1-2.08 2.07L5.29 10Zm6.23-6.19A12.7 12.7 0 0 1 14 7s-2.63 5.14-6.95 5.14A6.1 6.1 0 0 1 4 11.3L2.27 13l-1.4-1.36L11.9 1l1.23 1.2-1.6 1.6Z'/%3E%3C/svg%3E");
    }

    // moderator overrides other required
    &&__moderator {
        --_ta-bc: var(--orange-300);
        --_ta-bg: var(--orange-100);
        --_ta-fc: var(--orange-500);
        --_ta-bc-hover: var(--orange-300);
        --_ta-bg-hover: var(--orange-200);
        --_ta-fc-hover: var(--orange-600);
    }

    &&__required:not(&__moderator) {
        --_ta-bc: var(--theme-tag-required-border-color, var(--theme-tag-border-color, var(--black-400)));
        --_ta-bg: var(--theme-tag-required-background-color, var(--theme-tag-background-color, var(--black-150)));
        --_ta-fc: var(--theme-tag-required-color, var(--theme-tag-color, var(--black-500)));
        --_ta-bc-hover: var(--theme-tag-required-hover-border-color, var(--theme-tag-hover-border-color, var(--black-600)));
        --_ta-bg-hover: var(--theme-tag-required-hover-background-color, var(--theme-tag-hover-background-color, var(--black-200)));
        --_ta-fc-hover: var(--theme-tag-required-hover-color, var(--theme-tag-hover-color, var(--black-600)));
    }

    &__watched, // TODO: remove all single `&` watched styles once core no longer requires them
    &&__watched {
        --_ta-before-icon: url("data:image/svg+xml;,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 14 14'%3E%3Cpath d='M7.05 1C2.63 1 0 6.5 0 6.5S2.63 12 7.05 12C11.38 12 14 6.5 14 6.5S11.37 1 7.05 1ZM7 10.17A3.59 3.59 0 0 1 3.5 6.5 3.6 3.6 0 0 1 7 2.83c1.94 0 3.5 1.65 3.5 3.67A3.57 3.57 0 0 1 7 10.17Zm0-1.84c.97 0 1.75-.81 1.75-1.83S7.97 4.67 7 4.67s-1.75.81-1.75 1.83S6.03 8.33 7 8.33Z'/%3E%3C/svg%3E");
    }

    // CHILD ELEMENTS
    & button&--dismiss:not(.s-btn) {
        all: unset;
    }

    & &--dismiss,
    & button&--dismiss:not(.s-btn) { // Style adjustment to @Svg.ClearSm
        &:focus-visible {
            .focus-styles();
        }

        &:hover {
            .highcontrast-mode({
                color: var(--white);
            });

            background-color: var(--_ta-fc);
            color: var(--_ta-bg);
        }

        align-items: center;
        align-self: stretch;
        background-color: transparent;
        border-radius: var(--br-sm);
        color: inherit;
        cursor: pointer;
        display: flex;
        justify-content: center;
        margin: var(--su-static1) calc(var(--_ta-dismiss-padding) * -1) var(--su-static1) var(--_ta-dismiss-padding);
        padding: var(--_ta-dismiss-padding);
    }

    & &--sponsor { // The small sponsor favicon displayed within a tag
        img,
        .svg-icon {
            width: 100%;
            height: 100%;
        }

        align-self: center;
        border-radius: calc(var(--br-sm) - var(--su-static1));
        display: inline-flex;
        margin: calc(var(--su1) * -1) var(--su4) calc(var(--su2) * -1) calc(var(--su2) * -1);
        max-width: calc(var(--su-static16) + var(--su-static2));
    }

    // INTERACTION
    a& {
        &:hover,
        &:active {
            background-color: var(--_ta-bg-hover);
            border-color: var(--_ta-bc-hover);
            color: var(--_ta-fc-hover);
        }
    }

    &:focus-visible {
        .focus-styles(false, true);
    }

    background-color: var(--_ta-bg);
    border: var(--su-static1) solid var(--_ta-bc);
    border-radius: var(--_ta-br);
    color: var(--_ta-fc);
    font-size: var(--_ta-fs);
    line-height: var(--_ta-lh);
    padding-left: var(--_ta-pl);
    padding-right: var(--_ta-pr);

    align-items: center;
    display: inline-flex;
    font-weight: 700;
    justify-content: center;
    min-width: 0;
    text-decoration: none;
    vertical-align: middle;
    white-space: nowrap;
}
