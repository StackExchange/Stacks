//
//  STACK OVERFLOW
//  PROSE
//
//  This CSS comes from Stacks, our CSS & Pattern library for rapidly building
//  Stack Overflow. For documentation of all these classes and how to contribute,
//  visit https://stackoverflow.design/
//
//  ============================================================================
//  $  BASE
//  ----------------------------------------------------------------------------

.s-prose {
    // Base styling
    font-size: @fs-body2;
    line-height: @lh-lg;
    word-wrap: break-word;

    pre {
        word-wrap: normal;
    }

    code {
        font-size: @fs-body1;
    }

    sub,
    sup {
        code {
            font-size: 90%;
        }
    }

    hr {
        border: 0;
        color: var(--black-100);
        background-color: var(--black-100);
        height: 1px;
        margin-bottom: 1em;
    }

    li {
        word-wrap: break-word;

        pre {
            word-wrap: normal;
        }
    }

    //  ============================================================================
    //  $ HEADERS
    //  ----------------------------------------------------------------------------
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-weight: bold!important;
        margin-bottom: .5em;

        code {
            margin-bottom: .5em;
        }
    }

    h1,
    h1 code {
        font-size: @fs-headline2;
        margin-bottom: .1em;
    }

    h2,
    h2 code {
        font-size: @fs-headline1;
        margin-bottom: .3em;
    }

    h3,
    h3 code {
        font-size: @fs-title;
    }

    h4,
    h4 code {
        font-size: @fs-subheading;
    }
    
    h5,
    h5 code {
        font-size: @fs-body3;
    }
    
    h6,
    h6 code {
        font-size: @fs-body2;
    }

    //  ============================================================================
    //  $ IMAGES
    //  ----------------------------------------------------------------------------
    img {
        max-width: 100%;
        margin-bottom: 1em;
        vertical-align: bottom;
    }

    blockquote,
    li,
    p {
        img {
            margin-bottom: 0;
        }
    }

    //  ============================================================================
    //  $ LISTS
    //  ----------------------------------------------------------------------------
    ol,
    ul {
        margin-top: 0;
        margin-bottom: 1em;

        p:only-child,
        img:only-child,
        dl:only-child,
        blockquote:only-child,
        table:only-child,
        hr:only-child,
        p:last-child,
        img:last-child,
        dl:last-child,
        blockquote:last-child,
        table:last-child,
        hr:last-child {
            margin-bottom: 0;
        }

        // Within lists, we shouldn't have so much spacing
        // in between block-level elements.
        img,
        dl,
        p,
        blockquote,
        table,
        hr,
        dd,
        pre {
            margin-bottom: .5em;
        }
    }

    ol li,
    ul li {
        margin-bottom: .5em;

        &:last-child {
            margin-bottom: 0;
        }
    }

    li {
        > ul,
        > ol {
            padding-top: 0.5em;
        }
    }

    //  ============================================================================
    //  $ TABLES
    //  ----------------------------------------------------------------------------
    //  TODO
    //  In our markdown processor, we should wrap any tables in the atomic
    //  .overflow-x-auto to force horizontal scrolling
    //
    //  We would also most likely add `.s-table` to any `table`, and delete
    //  all these styles.
    table {
        display: block;
        max-width: 100%;
        width: 100%;
        border-spacing: 0;
        margin-bottom: 1em;
        padding: 1px; // Allow room for borders to render
        font-size: @fs-body1;
        overflow-x: auto;

        @scrollbar-styles();

        th,
        td {
            box-shadow: 0 0 0 1px var(--black-100);
            padding: @su8;
            background-color: var(--white);

            vertical-align: middle;
            color: var(--fc-medium);
            text-align: left;
        }

        th {
            font-weight: bold;
            color: var(--fc-dark);
        }

        // Header overrides
        thead {
            th {
                vertical-align: bottom;
                white-space: nowrap;
                background-color: var(--black-025);
                line-height: @lh-sm;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                font-size: @fs-fine;
            }

            tr {
                th:first-of-type {
                    border-top-left-radius: @br-sm;
                }

                th:last-of-type {
                    border-top-right-radius: @br-sm;
                }
            }
        }

        // Body overrides
        tbody {
            tr:last-of-type {
                td:first-child,
                th:first-child {
                    border-bottom-left-radius: @br-sm;
                }

                td:last-child,
                th:last-child {
                    border-bottom-right-radius: @br-sm;
                }
            }

            // Round the table if there's only one row without headers
            tr:only-child {
                td:first-child,
                th:first-child {
                    border-top-left-radius: @br-sm;
                    border-bottom-left-radius: @br-sm;
                }

                td:last-child,
                th:last-child {
                    border-top-right-radius: @br-sm;
                    border-bottom-right-radius: @br-sm;
                }
            }

            th {
                font-weight: normal;
            }
        }
    }

    //  ============================================================================
    //  $ DEFINITION LISTS
    //  ----------------------------------------------------------------------------
    dl {
        margin-top: 0;
        margin-bottom: 1em;
    }

    dt {
        font-weight: bold;
    }

    dd {
        margin: 0;
        margin-bottom: 1em;
        padding: 0;

        &:last-child {
            margin-bottom: 0;
        }
    }

    // The outer div enforces a max-width of 640px. The inner div has a height of 35 pixels, and a
    // padding-bottom of 56.25%. Padding percentages, even for top/bottom, are always relative
    // to the *width*, so the padding always has an aspect ratio of 1/0.5625, or 16/9. Thus in total,
    // the iframe has a height of 35 + width * 9/16. 35 pixels is the height of youtube's player controls,
    // so we have exactly the space we need for video + controls. The iframe is positioned absolutely
    // because only in that case does the containing block include the padding. The inner div exists
    // because without it you couldn't correctly handle max-width (as there obviously isn't a max-padding-bottom).
    .youtube-embed {
        width: 100%;
        max-width: 640px;
        position: relative;

        > div {
            width: 100%;
            height: 35px;
            padding-bottom: 56.25%;
            position: relative;

            iframe {
                position: absolute;
                width: 100%;
                height: 100%;
            }
        }
    }

    .soundcloud-embed iframe {
        width: 100%;
        max-width: 640px;
        height: 116px;
    }

    //  ============================================================================
    //  $ BLOCKQUOTES
    //  ----------------------------------------------------------------------------
    blockquote, q {
        quotes: none;
    }

    blockquote {
        position: relative;
        margin-left: 1em;
        margin-bottom: 1em;
        padding: .8em .8em .8em 1em;
        color: var(--black-600);

        &:before {
            content: "";
            display: block;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            width: 4px;
            border-radius: 8px;
            background: var(--black-150);
        }

        blockquote {
            margin-left: 0; // We don't need the intial indentation on nested blockquotes
        }

        * {
            &:last-child { margin-bottom: 0; }
        }
    }

    // Blockquotes inside list
    li {
        blockquote {
            margin: 0.5em 0 1em 0;
        }
    }

    //  ============================================================================
    //  $ KEYBOARD
    //  ----------------------------------------------------------------------------
    kbd {
        display: inline-block;
        margin: 0 .1em;
        padding: .1em .4em;
        font-family: @ff-sans;
        font-size: @fs-fine;
        line-height: @lh-lg;
        color: var(--black-800);
        text-shadow: 0 1px 0 var(--white);
        background-color: var(--black-075);
        border: 1px solid var(--black-300);
        border-radius: @br-sm;
        box-shadow: 0 1px 1px rgba(12, 13, 14, 0.15), inset 0 1px 0 0 @white;
        overflow-wrap: break-word;
    }

    //  ============================================================================
    //  $ CODE STYLES
    //  ----------------------------------------------------------------------------
    code {
        padding: @su2 @su4;
        color: var(--black-800);
        background-color: var(--black-075);
        border-radius: @br-sm;
    }

    pre {
        margin-bottom: 1.1em; // This is increased from 1em for better optical spacing
        padding: @su12;
        color: var(--black-800);
        width: auto;
        max-height: 600px;
        overflow: auto;
        font-size: 13px;
        background-color: var(--black-050);
        border-radius: @br-md;

        // Reset the code element when contained within a <pre>
        code {
            background-color: transparent;
            padding: 0;
            border-radius: 0;
        }

        @scrollbar-styles();
    }
}

#stacks-internals #darkmode('.s-prose kbd', {
    box-shadow: 0 1px 1px rgba(12, 13, 14, 0.8);
    border-color: transparent;
    border-top-color: @black-500;
});