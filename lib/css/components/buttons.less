.s-btn {
    --_baw: var(--su-static1);
    --_bc: transparent;
    --_bg: transparent;
    --_bg-active: var(--theme-button-active-background-color);
    --_bg-hover: var(--theme-button-hover-background-color);
    --_bg-selected: var(--theme-button-selected-background-color);
    --_br: var(--br-sm);
    --_bs: inset 0 1px 0 0 hsla(0, 0, 100%, 0.7);
    --_fc: var(--theme-button-color);
    --_fs: var(--fs-body1);
    --_fc-active: var(--_fc-hover);
    --_fc-hover: var(--theme-button-hover-color);
    --_fc-selected: var(--theme-button-selected-color);
    --_focus-ring: 0 0 0 var(--su-static4) var(--focus-ring);
    --_hc-bc: currentColor;
    --_p: 0.8em;
    // Filled
    --_filled-bc: var(--theme-button-filled-border-color);
    --_filled-bc-active: var(--theme-button-filled-active-border-color);
    --_filled-bc-selected: var(--theme-button-filled-selected-border-color);
    --_filled-bg: var(--theme-button-filled-background-color);
    --_filled-bg-active: var(--theme-button-filled-active-background-color);
    --_filled-bg-hover: var(--theme-button-filled-hover-background-color);
    --_filled-bg-selected: var(--theme-button-filled-selected-background-color);
    --_filled-fc: var(--theme-button-filled-color);
    --_filled-fc-active: var(--theme-button-filled-hover-color); // Note: hover color used here intentionally
    --_filled-fc-hover: var(--theme-button-filled-hover-color);
    --_filled-fc-selected: var(--theme-button-filled-selected-color);
    --_filled-hc-bc: var(--_hc-bc);
    // Outlined
    --_outlined-bc: var(--theme-button-outlined-border-color);
    --_outlined-bc-selected: var(--theme-button-outlined-selected-border-color);
    --_outlined-bg: var(--theme-button-outlined-background-color);
    --_outlined-bg-selected: var(--theme-button-selected-background-color);
    --_outlined-fc-selected: var(--theme-button-selected-color);
    --_outlined-hc-bc: var(--_hc-bc);
    // Dropdown
    --_dropdown-bw: var(--su-static4);
    // Number
    --_number-fc: var(--white);

    &[disabled],
    &[aria-disabled="true"] {
        --_bs: none !important;
        opacity: var(--_o-disabled-static);
        pointer-events: none;
    }

    button &,
    button[type="submit"] &,
    button[type="reset"] & {
        // Guard against the difference in configurable resets
        // Eric Meyer's reset does not include this, while normalize.css does
        // Correct the inability to style buttons in iOS and Safari.
        -webkit-appearance: button;
    }

    // Override for buttons having inline-block by default
    &.grid {
        --_d: flex;
    }

    .dark-mode({
        --_bs: none;
    });

    .highcontrast-mode({
        --_bc: var(--_hc-bc);
        --_filled-bc: var(--_filled-hc-bc);
        --_filled-bc-active: (--_filled-bc);
        --_filled-bc-hover: (--_filled-bc);
        --_outlined-bc: var(--_outlined-hc-bc);
    });

    // Modifiers ---------------------------------------------------------------
    // Styles
    &.is-selected,
    .s-btn--radio:checked + & {
        --_bg: var(--_bg-selected);
        --_bs: none;
        --_fc: var(--_fc-selected);
    }
    &.s-btn__filled {
        --_bc: var(--_filled-bc);
        --_bc-active: var(--_filled-bc-active);
        --_bg: var(--_filled-bg);
        --_bg-active: var(--_filled-bg-active);
        --_bg-hover: var(--_filled-bg-hover);
        --_fc: var(--_filled-fc);
        --_fc-active: var(--_filled-fc-active); 
        --_fc-hover: var(--_filled-fc-hover);
    
        &:not(.is-selected) {
            &:hover,
            &:focus {
                --_bg: var(--_bg-hover);
                --_fc: var(--_fc-hover);
            }
        
            &:active {
                --_bg: var(--_bg-active);
                --_bc: var(--_filled-bc-active);
                --_fc: var(--_fc-active);
            }
        }
        &.is-selected {
            --_bc: var(--_filled-bc-selected);
            --_bg: var(--_filled-bg-selected);
            --_fc: var(--_filled-fc-selected);
        }
        .highcontrast-mode({
            --_bc: var(--_filled-hc-bc);
        });
    }
    &.s-btn__outlined {
        --_bc: var(--_outlined-bc);
        --_bg: var(--_outlined-bg);
    
        &.is-selected {
            --_bc: var(--_outlined-bc-selected);
            --_bg: var(--_outlined-bg-selected);
            --_fc: var(--_outlined-fc-selected);
        }
        .highcontrast-mode({
            --bc: var(--_outlined-hc-bc);
        });
    }

    // Additional elements
    &.is-loading {
        .svg-icon:first-child {
            margin-left: -23px;
            // If the first thing in the button is an icon, let's hide it on loading
            // We only want to modify the visibility, since we still want it to have shape and keep the same layout.
            opacity: 0;
        }
    }
    &.s-btn__dropdown {
        padding-right: calc(var(--_p) * 2.5);
    
        &:after {
            content: "";
            position: absolute;
            z-index: var(--zi-active);
            top: calc(50% - var(--su-static2));
            right: var(--_p);
            border-style: solid;
            border-width: var(--_dropdown-bw);
            border-top-width: var(--_dropdown-bw);
            border-bottom-width: 0;
            border-color: currentColor transparent;
            pointer-events: none;
        }
    }
    &.s-btn__icon {
        //  -- BUTTONS WITH ICONS
        //  ------------------------------------------------------------------------
        //  [1] Most svg icons are 18px tall, but the button's line-height is 1 (13px).
        //      This means we need to off set the margin y-axis so we don't add
        //      additional height to the button.
        //  ------------------------------------------------------------------------
        .svg-icon {
            vertical-align: baseline;
            margin-top: -0.3em;         // [1]
            margin-bottom: -0.3em;      // [1]
            transition: opacity 200ms var(--te-smooth); // Animate the transition to .is-loading
        }
    }
    // Sizes
    &.s-btn__xs {
        --_dropdown-bw: calc(var(--su-static4) - var(--su-static1));
        --_fs: var(--fs-fine);
        --_p: 0.6em;
    }
    &.s-btn__sm {
        --_fs: var(--fs-caption);
    }
    &.s-btn__md {
        --_br: calc(var(--br-sm) + var(--su-static1));
        --_fs: var(--fs-body3);
        --_p: 0.7em;
    }

    &:focus,
    .s-btn--radio:checked:focus + & {
        box-shadow: var(--_focus-ring);
        outline: none;
    }

    // TODO: account for radio buttons
    &:not(.is-selected) {
        &:hover,
        &:focus {
            background-color: var(--_bg-hover);
            color: var(--_fc-hover);
        }

        &:active {
            background-color: var(--_bg-active);
            color: var(--_fc-active);
        }
    }

    // base rules
    background-color: var(--_bg);
    border: var(--_baw) solid var(--_bc);
    border-radius: var(--_br);
    box-shadow: var(--_bs);
    color: var(--_fc);
    cursor: pointer;
    display: inline-block;
    font-family: inherit;
    font-size: var(--_fs);
    font-weight: normal;
    line-height: var(--lh-sm);
    position: relative;
    padding: var(--_p);
    outline: none;
    text-align: center;
    text-decoration: none;
    user-select: none;
}

// ELEMENTS --------------------------------------------------------------------
.s-btn--badge {
    opacity: var(--_o-disabled);
    display: inline-block;
    border-radius: var(--br-sm);
    padding: var(--su2) calc(var(--su4) - var(--su1));
    font-size: var(--fs-caption);
    line-height: var(--lh-xs);
    background-color: currentColor;
}

.s-btn--number {
    color: var(--_number-fc);
}
.s-btn--radio {
    .v-visible-sr;
}

// VARIANTS --------------------------------------------------------------------
.s-btn__danger {
    --_bg-active: var(--red-100);
    --_bg-hover: var(--red-050);
    --_bg-selected: var(--red-200);
    --_bs: inset 0 1px 0 0 hsla(0, 0%, 100%, 0.4);
    --_fc: var(--red-600);
    --_fc-hover: var(--red-700);
    --_fc-selected: var(--red-900);
    --_focus-ring: 0 0 0 var(--su-static4) var(--focus-ring-error);
    // Filled
    --_filled-bc: transparent;
    --_filled-bc-selected: var(--_filled-bc);
    --_filled-bg: var(--red-500);
    --_filled-bg-active: var(--red-700);
    --_filled-bg-hover: var(--red-600);
    --_filled-bg-selected: var(--red-800);
    --_filled-fc: var(--white);
    --_filled-fc-active: var(--_filled-fc);
    --_filled-fc-hover: var(--_filled-fc);
    --_filled-fc-selected: var(--_filled-fc);
    --_filled-hc-bc: transparent;
    // Outlined
    --_outlined-bc: var(--red-500);
    --_outlined-bc-selected: var(--red-700);
    --_outlined-bg: var(--_bg);
    --_outlined-bg-selected: var(--_bg-selected);
    --_outlined-fc-selected: var(--_fc-selected);

    &.s-btn__filled {
        --_number-fc: var(--black);

        &:not(.is-selected) {
            .highcontrast-dark-mode({
                --_number-fc: var(--black);
            });
        }
    }
    .dark-mode({
        --_outlined-bc-selected: var(--red-600);

        &:not(.is-selected) {
            --_filled-bg: var(--red-500);
            --_filled-fc: var(--black);
            --_number-fc: var(--white);
        }
    });
    .highcontrast-dark-mode({
        --_filled-fc: var(--white);

        &.s-btn__filled {
            &:not(.is-selected) {
                    --_number-fc: var(--black);
            }
        }
    });
}

.s-btn__muted {
    --_bg-active: var(--black-050);
    --_bg-hover: var(--black-025);
    --_bg-selected: var(--black-075);
    --_bs: inset 0 1px 0 0 hsla(0, 0%, 100%, 0.4);
    --_fc: var(--black-500);
    --_fc-hover: var(--black-600);
    --_fc-selected: var(--black-700);
    --_focus-ring: 0 0 0 var(--su-static4) var(--focus-ring-muted);
    // Filled
    --_filled-bc: transparent;
    --_filled-bc-selected: var(--_filled-bc);
    --_filled-bg: var(--black-100);
    --_filled-bg-active: var(--black-200);
    --_filled-bg-hover: var(--black-150);
    --_filled-bg-selected: var(--black-350);
    --_filled-fc: var(--black-700);
    --_filled-fc-active: var(--_filled-fc);
    --_filled-fc-hover: var(--_filled-fc);
    --_filled-fc-selected: var(--black-800);
    --_filled-hc-bc: transparent;
    // Outlined
    --_outlined-bc: var(--black-300);
    --_outlined-bc-selected: var(--black-400);
    --_outlined-bg: var(--_bg);
    --_outlined-bg-selected: var(--_bg-selected);
    --_outlined-fc-selected: var(--_fc-selected);

    .highcontrast-mode({
        --_filled-bg: var(--black-400);
        --_filled-bg-active: var(--black-400);
        --_filled-bg-hover: var(--black-400);
        --_filled-bg-selected: var(--black-700);
        --_filled-fc: var(--white);
        --_filled-fc-selected: var(--_filled-fc);

        &.s-btn__filled {
            --_number-fc: var(--black);
        }
    });
}

.s-btn__primary {
    --_bg: var(--theme-button-primary-background-color);
    --_bg-active: var(--theme-button-primary-active-background-color);
    --_bg-hover: var(--theme-button-primary-hover-background-color);
    --_bg-selected: var(--theme-button-primary-selected-background-color);
    --_bs: inset 0 1px 0 0 hsla(0, 0%, 100%, 0.4);
    --_fc: var(--theme-button-primary-color);
    --_fc-hover: var(--theme-button-primary-hover-color);
    --_fc-selected: var(--theme-button-primary-selected-color);
    --_hc-bc: transparent;
    --_number-fc: var(--theme-button-primary-number-color);

    .dark-mode({
        &:not(.is-selected) {
            --_bg: var(--theme-secondary-300);
            --_bg-active: var(--_bg);
            --_bg-hover: var(--_bg);
            --_fc: var(--black);
            --_fc-active: var(--_fc);
            --_fc-hover: var(--_fc);
            --_number-fc: var(--white);
        }
    });
    .highcontrast-dark-mode({
        &:not(.is-selected) {
            --_bg: var(--theme-secondary-400);
            --_fc: var(--white);
            --_number-fc: var(--black);
        }
    })
}

// RESETS ----------------------------------------------------------------------
.s-btn__link,
.s-btn__unset,
.s-btn__unset:hover,
.s-btn__unset:active,
.s-btn__unset:focus {
    --_baw: none;
    --_bg: none;
    --_bg-active: none;
    --_bg-hover: none;
    --_br: 0;
    --_bs: none;
    --_p: 0;
    --_focus-ring: none;
    outline: initial;
}
.s-btn__unset,
.s-btn__link {
    &:focus,
    &:focus-visible {
        outline-style: auto;
    }
}

.s-btn__link {
    display: inline;
    font: inherit;
    text-align: inherit;

    .s-link();

    &:hover,
    &:active,
    &:focus,
    &[disabled],
    &[aria-disabled="true"] {
        --_bg: none;
        --_bg-active: none;
        --_bg-hover: none;
    }

    &.s-btn__dropdown {
        padding-right: 0.9em;
    }
}

.s-btn__unset,
.s-btn__unset:hover,
.s-btn__unset:active,
.s-btn__unset:focus {
    --_fc: unset;
    --_fc-active: unset;
    --_fc-hover: unset;
    cursor: default;
    font: unset;
    user-select: auto;
}


// SOCIAL ----------------------------------------------------------------------
.s-btn__facebook {
    @_fb-brand: #385499;
    --_bc: transparent;
    --_bg: @_fb-brand;
    --_bg-active: darken(@_fb-brand, 10%);
    --_bg-hover: darken(@_fb-brand, 5%);
    --_fc: #fff;
    --_fc-active: var(--_fc);
    --_fc-hover: var(--_fc);
    --_hc-bc: transparent;
}
.s-btn__google {
    --_bc: var(--bc-medium);
    --_bg: var(--white);
    --_bg-active: var(--black-050);
    --_bg-hover: var(--black-025);
    --_fc: var(--fc-medium);
    --_fc-active: var(--fc-dark);
    --_fc-hover: var(--black-800); // TODO standardize around --fc-* custom properties
    --_focus-ring: 0 0 0 var(--su-static4) var(--focus-ring-muted);
}
.s-btn__github {
    --_bg: var(--black-750);
    --_bg-active: var(--black);
    --_bg-hover: var(--black-800);
    --_fc: var(--white);
    --_fc-active: var(--white);
    --_fc-hover: var(--white);
    --_focus-ring: 0 0 0 var(--su-static4) var(--focus-ring-muted);
    --_hc-bc: transparent;
}
